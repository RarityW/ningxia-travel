<!-- å“ç‰Œç²¾é€‰é¡µé¢ - å®é€‰å¥½ç¤¼åˆ†ç±»å±•ç¤º -->
<custom-nav title="å“ç‰Œç²¾é€‰" back="{{true}}" background="#FFFFFF" color="#000000" bind:onBack="handleBack"></custom-nav>

<view class="container">
  <!-- åˆ†ç±»æ ‡ç­¾æ  -->
  <scroll-view class="category-tabs" scroll-x show-scrollbar="{{false}}">
    <view class="tabs-list">
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="tab-item {{currentCategory === item.key ? 'active' : ''}}"
        bindtap="switchCategory"
        data-key="{{item.key}}"
      >
        <text class="tab-icon">{{item.icon}}</text>
        <text class="tab-name">{{item.name}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- å½“å‰åˆ†ç±»æ ‡é¢˜ -->
  <view class="section-header">
    <text class="section-title">{{currentCategoryName}}</text>
    <text class="section-count">å…±{{total}}ä»¶å•†å“</text>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <scroll-view 
    class="product-scroll" 
    scroll-y 
    enhanced
    bindscrolltolower="loadMore"
  >
    <view class="product-grid">
      <view 
        wx:for="{{products}}" 
        wx:key="id"
        class="product-card"
        bindtap="goToDetail"
        data-id="{{item.id}}"
      >
        <view class="image-wrapper">
          <image class="product-img" src="{{item.coverImage}}" mode="aspectFill" lazy-load />
          <view class="product-badge" wx:if="{{item.sales > 50}}">çƒ­é”€</view>
        </view>
        <view class="product-info">
          <text class="product-name">{{item.name}}</text>
          <view class="product-bottom">
            <view class="price-box">
              <text class="currency">Â¥</text>
              <text class="price">{{item.price}}</text>
              <text class="original-price" wx:if="{{item.originalPrice}}">Â¥{{item.originalPrice}}</text>
            </view>
            <text class="sales-text">å·²å”®{{item.sales || 0}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="loading" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view class="no-more" wx:if="{{!hasMore && products.length > 0}}">
      <text>â€” å·²åŠ è½½å…¨éƒ¨ â€”</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty" wx:if="{{!loading && products.length === 0}}">
      <text class="empty-icon">ğŸ</text>
      <text class="empty-text">æš‚æ— å•†å“ï¼Œæ•¬è¯·æœŸå¾…</text>
    </view>
  </scroll-view>
</view>
